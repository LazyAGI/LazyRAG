_format_version: "3.0"

# Route order: more specific paths first so /api/chat is not swallowed by /api
services:
  - name: auth-service
    url: http://auth-service:8000
    routes:
      - name: auth-route
        paths:
          - /api/auth
        strip_path: false
        plugins:
          - name: rbac-auth
            config:
              auth_service_url: http://auth-service:8000

  # Algorithm services: no rbac-auth (frontend -> kong(rbac) -> backend(acl) -> algorithm)
  - name: chat-service
    url: http://chat:8046
    routes:
      - name: chat-route
        paths:
          - /api/chat
        strip_path: false

  - name: core-service
    url: http://core:8000
    routes:
      - name: core-route
        paths:
          - /api
        strip_path: false
        plugins:
          - name: rbac-auth
            config:
              auth_service_url: http://auth-service:8000
